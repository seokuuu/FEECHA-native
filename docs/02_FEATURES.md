# FEE-CHA 기능 명세서

## 목차
1. [사용자 관리](#1-사용자-관리)
2. [게시판 시스템](#2-게시판-시스템)
3. [매칭 시스템](#3-매칭-시스템)
4. [채팅 시스템](#4-채팅-시스템)
5. [견적 시스템](#5-견적-시스템)
6. [예약 & 결제](#6-예약--결제)
7. [캘린더 & 스케줄](#7-캘린더--스케줄)
8. [리뷰 & 평점](#8-리뷰--평점)
9. [알림 시스템](#9-알림-시스템)
10. [정산 시스템](#10-정산-시스템)

---

## 1. 사용자 관리

### 1.1 회원가입/로그인

#### 이메일 회원가입
- 이메일, 비밀번호, 이름, 전화번호 입력
- 이메일 인증 (선택적)
- 역할 선택 (클라이언트 / 사장님)

#### 소셜 로그인
- 카카오 로그인
- 구글 로그인
- 애플 로그인 (iOS)

#### 역할 구분
- **클라이언트(팬)**: 커피차 의뢰하는 사용자
- **사장님(업체)**: 커피차 서비스 제공자
- **관리자**: 플랫폼 운영자 (CMS에서만 접근)

### 1.2 프로필 관리

#### 클라이언트 프로필
- 기본 정보: 이름, 이메일, 전화번호
- 프로필 사진
- 의뢰 내역
- 리뷰 작성 내역
- 알림 설정

#### 사장님 프로필
- 기본 정보
  - 상호명
  - 사업자등록번호
  - 대표자명
  - 연락처
  - 주소
- 서비스 정보
  - 활동 지역 (시/도, 시/군/구 선택)
  - 기본 가격 (인원 기준)
  - 제공 옵션 (커피, 도시락, 현수막, 배너 등)
  - 옵션별 가격
- 포트폴리오
  - 사진 갤러리 (최대 20장)
  - 과거 작업 사례
  - 연예인 인증샷
- 차량 정보
  - 차량 사진 (정면, 측면, 내부)
  - 차량 크기 (주차 공간 안내)
  - 전기 필요 여부
- 인증 서류
  - 사업자등록증
  - 영업신고증
  - 식품 위생 교육증
  - 보험 가입 증명서 (선택)

### 1.3 사장님 인증 프로세스
1. 사장님으로 회원가입
2. 인증 서류 업로드
3. 관리자 검토 대기
4. 승인 / 거절
5. 승인 시 프로필 공개 가능

---

## 2. 게시판 시스템

### 2.1 사장님 프로필 게시판 (공급)

#### 게시글 구조
```
제목: [지역] 상호명 - 특징
예시: [서울 전역] 프리미엄 커피차 - 주말 가능

기본 정보:
- 상호명
- 활동 지역
- 기본 가격 (200인분 기준)
- 응답 속도 배지

제공 서비스 (체크박스):
☑ 커피/음료 (필수)
☑ 도시락/케이터링
☑ 현수막 제작
☑ 배너 제작
☐ 디저트 추가
☑ 현장 사진 촬영

옵션별 가격:
- 커피/음료 (200인): 100만원
- 도시락 (1인): 8,000원
- 현수막 (3m): 15만원
- X배너: 5만원

포트폴리오:
- 사진 갤러리

후기:
- 평균 별점
- 리뷰 목록
```

#### 검색/필터
- 지역별 (서울, 경기, 인천 등)
- 가격대별 (50만원 이하, 50-100만원, 100만원 이상)
- 옵션별 (도시락 가능, 현수막 제작 가능 등)
- 별점순
- 최신순

### 2.2 클라이언트 의뢰 게시판 (수요)

#### 게시글 구조
```
제목: 날짜 + 지역 + 간단 설명
예시: 12/31 경기 남양주 드라마 촬영장 커피차 구합니다

기본 정보:
- 날짜: 2025-12-31
- 시간: 10:00 ~ 18:00
- 장소: 경기도 남양주시 OO동 (상세 주소는 채팅에서)
- 예상 인원: 150명
- 예산: 80 ~ 120만원

필요한 서비스 (체크박스):
☑ 커피/음료
☑ 도시락 (점심)
☑ 현수막 제작 필요
☐ 배너 제작
☑ 디저트 추가

추가 요청사항:
- 주차 공간 5m x 5m 확보 가능
- 전기 공급 가능
- 디자인 시안 있음 (첨부 파일)

현장 정보:
- 소속사 승인: 완료 / 진행중 / 예정
- 촬영 타입: 드라마 / 영화 / 예능 / 기타

상태: 견적 모집 중 (3개 견적 접수됨)
```

#### 검색/필터
- 지역별
- 날짜별
- 예산별
- 상태별 (모집 중, 마감, 완료)

---

## 3. 매칭 시스템

### 3.1 직접 선택 방식

**흐름:**
1. 클라이언트가 사장님 프로필 게시판 탐색
2. 마음에 드는 업체 선택
3. "견적 요청하기" 버튼 클릭
4. 의뢰 정보 입력 (날짜, 장소, 인원, 옵션 등)
5. 사장님에게 견적 요청 전송
6. 채팅으로 협의
7. 견적서 수령
8. 예약 확정

**특징:**
- 신뢰도 높은 업체 선택 가능
- 포트폴리오와 후기 참고
- 수수료: 5%

### 3.2 견적 비교 방식 (입찰)

**흐름:**
1. 클라이언트가 의뢰 게시판에 요청서 작성
2. 조건 맞는 사장님들에게 알림 전송 (5~10명)
3. 사장님들이 견적서 제출
4. 클라이언트가 견적 비교 (표 형식)
5. 원하는 견적 선택
6. 채팅으로 협의
7. 예약 확정

**특징:**
- 여러 견적 비교 가능
- 가격 경쟁력 확보
- 수수료: 10%

### 3.3 알림 우선순위 알고리즘

**우선순위 결정 요소:**
1. 활동 지역 일치 여부 (필수)
2. 날짜 가능 여부 (캘린더 확인)
3. 응답률 (높을수록 우선)
4. 평균 별점 (높을수록 우선)
5. 거리 (가까울수록 우선)
6. 빠른 응답 횟수 (많을수록 우선)

**알림 발송:**
- 1차: 상위 5~10명에게 즉시 알림
- 2차: 10~20분 후 반응 없으면 추가 5명에게 알림
- 빠른 응답 시 "빠른 응답 배지" 부여

---

## 4. 채팅 시스템

### 4.1 기본 채팅 기능

- **1:1 실시간 채팅**
  - 클라이언트 ↔ 사장님
  - Socket.io 기반

- **메시지 기능**
  - 텍스트 메시지
  - 이미지 전송 (JPG, PNG, HEIC 등)
  - 파일 전송 (PDF, PSD, AI 등 - 최대 50MB)
  - 이미지 미리보기

- **상태 표시**
  - 읽음/안읽음 표시
  - 상대방 입력 중 표시
  - 온라인/오프라인 상태

### 4.2 특수 기능

#### 견적 확정 버튼
채팅 내에서 바로 견적 확정 가능
```
[견적서 카드]
총액: 120만원
- 커피/음료: 100만원
- 도시락: 12만원
- 현수막: 8만원

[견적 확정하기] 버튼
```

#### 예약금 결제 버튼
확정 후 바로 결제 진행
```
[결제 카드]
예약금: 36만원 (30%)
잔금: 84만원 (현장 결제)

[예약금 결제하기] 버튼
```

#### 옵션 추가 요청
채팅 중 옵션 변경 가능
```
[옵션 추가 요청]
☐ 디저트 추가 (+15만원)
☐ 샌드위치 추가 (+10만원)

[요청하기] 버튼
```

#### 시간/장소 변경 요청
```
[변경 요청]
변경 항목: 시간
기존: 10:00 ~ 18:00
변경: 13:00 ~ 21:00

[변경 요청하기] 버튼
```

### 4.3 채팅 제한

- **견적 단계**: 100% 내부 채팅만 사용
- **예약 확정 후**: 전화번호 노출 가능 (선택적)
- **외부 채팅 유도 방지**: 카톡/전화번호 입력 시 경고

---

## 5. 견적 시스템

### 5.1 견적서 템플릿

```
[견적서]
작성일: 2025-12-30
유효기간: 2026-01-06 (7일)

[기본 정보]
의뢰 날짜: 2025-12-31
장소: 경기도 남양주시 OO동
시간: 10:00 ~ 18:00
예상 인원: 150명

[견적 내역]
1. 커피/음료 (150인)          ₩ 900,000
2. 도시락 (150인 x 8,000)      ₩ 1,200,000
3. 현수막 제작 (3m)            ₩ 150,000
4. X배너 제작                  ₩ 50,000
5. 출장비 (서울→남양주 30km)   ₩ 30,000
───────────────────────────────────
소계:                          ₩ 2,330,000
부가세 (10%):                   ₩ 233,000
───────────────────────────────────
총액:                          ₩ 2,563,000

[결제 방식]
예약금 (30%):                  ₩ 768,900
잔금 (현장):                   ₩ 1,794,100

[특이사항]
- 디자인 시안 확인 후 현수막 제작 시작
- 전날 최종 인원 확정 필요
- 주차 공간 5m x 5m 확보 요청

[취소 정책]
D-7 이전: 100% 환불
D-3 이전: 50% 환불
D-1 이후: 환불 불가
```

### 5.2 견적 비교 UI

| 항목 | A업체 | B업체 | C업체 |
|------|-------|-------|-------|
| 총액 | 256만원 | 230만원 | 280만원 |
| 별점 | ⭐ 4.8 | ⭐ 4.5 | ⭐ 4.9 |
| 응답 속도 | 5분 | 30분 | 10분 |
| 커피/음료 | ✅ | ✅ | ✅ |
| 도시락 | ✅ | ✅ | ✅ |
| 현수막 | ✅ | ❌ | ✅ |
| 배너 | ✅ | ✅ | ✅ |

---

## 6. 예약 & 결제

### 6.1 예약 프로세스

1. **견적 확정**
   - 채팅에서 "견적 확정" 버튼 클릭
   - 예약 상세 확인 화면

2. **예약금 결제**
   - 총액의 20~30% (사장님이 설정)
   - 포트원 결제 연동
   - 결제 수단: 카드, 카카오페이, 네이버페이, 토스

3. **예약 확정**
   - 결제 완료 시 예약 자동 확정
   - 사장님 캘린더에 자동 등록
   - 양측에 알림 발송

### 6.2 결제 수단

- 신용카드 / 체크카드
- 간편결제 (카카오페이, 네이버페이, 토스)
- 계좌이체 (포트원 제공)

### 6.3 예약 변경

#### 시간 변경
- 동일 날짜 내 시간 변경: 추가 비용 없음
- 사장님 승인 필요
- 채팅에서 변경 요청

#### 장소 변경
- 거리 차이에 따라 출장비 추가/차감
- 자동 계산 또는 사장님이 수동 조정
- 사장님 승인 필요

#### 날짜 변경
- 취소 정책에 따라 환불
- 새 날짜로 재예약
- 수수료 일부 면제 가능

### 6.4 취소 & 환불

**환불 정책:**
- D-7 이전: 예약금 100% 환불
- D-3 이전: 예약금 50% 환불
- D-1 이후: 환불 불가

**제작사/촬영 사유 예외:**
- 촬영 취소/연기 증빙 시 100% 환불 가능
- 소속사 공문, 제작사 확인서 등 필요

**환불 처리:**
- 자동 환불 (포트원 API)
- 영업일 기준 3~5일 소요
- 취소 수수료: 플랫폼 수수료는 환불 안됨

### 6.5 잔금 결제

- **현장 직거래** (기본)
  - 사장님이 현장에서 카드/현금 수령
  - 플랫폼 비개입
  - 거래 완료 버튼만 클릭

- **플랫폼 결제** (선택적, 나중에 추가)
  - 당일 또는 완료 후 플랫폼에서 잔금 결제
  - 정산 자동화

---

## 7. 캘린더 & 스케줄

### 7.1 사장님 캘린더

**기능:**
- 예약 일정 표시
- 예약 불가 날짜 설정
- 반복 일정 설정
- 월/주/일 뷰

**예약 충돌 방지:**
- 이미 예약된 날짜는 자동으로 선택 불가
- 준비/이동 시간 고려 (선택적)

### 7.2 클라이언트 캘린더

**기능:**
- 내 의뢰 일정 확인
- 예약 확정 일정 표시
- D-Day 카운터

### 7.3 반복 예약

**사용 사례:**
- 3일 연속 촬영
- 2주간 매주 목요일

**기능:**
- 반복 패턴 설정 (매일, 매주, 특정 날짜)
- 일괄 견적 요청
- 묶음 할인 (선택적)

### 7.4 당일 알림

- **D-1일**: "내일 촬영장 서포트가 있습니다" 알림
- **D-Day 오전**: "오늘 OO시에 출발 예정입니다" (사장님)
- **도착 시**: "현장에 도착했습니다" (사장님 → 클라이언트)

---

## 8. 리뷰 & 평점

### 8.1 리뷰 작성

**조건:**
- 거래 완료 후 자동으로 리뷰 작성 활성화
- 거래 없는 리뷰 작성 불가

**구성:**
```
별점: ⭐⭐⭐⭐⭐ (5점 만점)

평가 항목 (각 5점):
- 서비스 품질
- 친절도
- 시간 약속 준수
- 음식 맛
- 가격 대비 만족도

리뷰 내용:
(텍스트 입력, 최소 20자)

사진 첨부:
(선택적, 최대 5장)
- 커피차 현장 사진
- 연예인 인증샷
```

### 8.2 사장님 → 클라이언트 평가 (선택적)

**평가 항목:**
- 소통의 원활함
- 현장 협조도
- 결제 신속성

**공개 여부:** 비공개 (플랫폼 내부용)

### 8.3 후기 관리

**허위 후기 방지:**
- 실제 거래 기반만 작성 가능
- 신고 기능
- 관리자 검토

**후기 인센티브:**
- 사진 포함 후기 작성 시 포인트 지급 (선택적)
- 연예인 인증샷 포함 시 추가 포인트

---

## 9. 알림 시스템

### 9.1 푸시 알림 (Mobile)

**클라이언트:**
- 견적서 도착
- 채팅 메시지
- 예약 확정
- D-1 알림
- 사장님 출발 알림
- 리뷰 요청

**사장님:**
- 새 의뢰 등록 (지역 기반)
- 견적 선택됨
- 채팅 메시지
- 예약금 결제 완료
- 리뷰 작성됨
- 정산 완료

### 9.2 앱 내 알림

- 알림 센터
- 읽음/안읽음 표시
- 알림 클릭 시 해당 화면 이동

### 9.3 이메일 알림 (선택적)

- 예약 확정 확인서
- 결제 영수증
- 정산 내역
- 중요 공지사항

---

## 10. 정산 시스템

### 10.1 수수료 구조

**거래별 수수료:**
- 직접 선택 방식: 5%
- 견적 비교 방식: 10%
- 플랫폼이 예약금에서 자동 차감

**예시:**
```
총 거래액: 200만원
예약금 (30%): 60만원
플랫폼 수수료 (10%): 20만원
사장님 정산 금액: 40만원 (예약금) + 140만원 (잔금) = 180만원
```

### 10.2 정산 주기

**옵션 1: D+7 정산 (추천)**
- 거래 완료 후 7일 뒤 자동 정산
- 분쟁 기간 확보

**옵션 2: 월 2회 정산**
- 매월 1일, 15일 정산
- 대량 정산 시 효율적

### 10.3 정산 내역

**사장님 대시보드:**
- 이번 달 총 매출
- 정산 예정 금액
- 정산 완료 내역
- 수수료 내역
- 엑셀 다운로드

### 10.4 세금 처리

**부가세:**
- 수수료에 부가세 10% 포함
- 세금계산서 발행 (사업자 등록 시)

**원천징수:**
- 개인 사장님의 경우 3.3% 원천징수 (선택적)

### 10.5 정산 방법

- 사장님이 등록한 계좌로 자동 송금
- 정산 알림 발송
- 정산 내역서 제공

---

## 추가 고려사항

### 보험 & 안전
- 사장님 보험 가입 여부 표시 (선택적)
- 위생 교육 인증 필수
- 식품 사고 발생 시 면책 조항

### 디자인 서비스
- 간단한 템플릿 제공 (선택적)
- 외부 디자이너 연결 (나중에)
- 업체에 디자인 의뢰 옵션

### 파트너십
- 현수막/배너 제작 업체 연동 (나중에)
- 촬영지 정보 제공 (나중에)
- 소속사 제휴 (나중에)

---

## 관련 문서

- [백엔드 요구사항](./03_BACKEND_REQUIREMENTS.md)
- [API 명세서](./04_API_SPECS.md)
- [데이터베이스 스키마](./05_DB_SCHEMA.md)
